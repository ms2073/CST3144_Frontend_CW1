<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>After-School Lessons</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app">
        <!-- Header Section -->
        <header class="bg-light py-5">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1 class="display-4 fw-bold text-primary mb-2">After-School Lessons</h1>
                        <p class="lead text-muted">Browse and book after-school classes for your children</p>
                    </div>
                    <div class="col-md-4 text-end">
                        <button class="btn btn-primary btn-lg position-relative" @click="toggleCart" :disabled="cart.length === 0">
                            <i class="fas fa-shopping-cart me-2"></i>
                            View Cart
                            <span v-if="cart.length > 0" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                                {{ cart.length }}
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main class="container mt-4">
            <!-- Lesson List View -->
            <div v-if="!showCart">
                <!-- Search Section -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h3 class="mb-3">Search Lessons</h3>
                        <div class="input-group">
                            <input 
                                type="text" 
                                class="form-control form-control-lg" 
                                placeholder="Search by subject, location, price, or spaces..." 
                                v-model="searchQuery"
                                @input="searchLessons"
                            >
                        </div>
                    </div>
                </div>

                <!-- Sorting Section -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <h5 class="mb-2">Sort by</h5>
                        <select class="form-select" v-model="sortBy">
                            <option value="subject">Subject</option>
                            <option value="location">Location</option>
                            <option value="price">Price</option>
                            <option value="spaces">Availability (Spaces)</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <h5 class="mb-2">Order</h5>
                        <select class="form-select" v-model="sortOrder">
                            <option value="asc">Ascending</option>
                            <option value="desc">Descending</option>
                        </select>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4" v-for="lesson in filteredLessons" :key="lesson.id">
                        <lesson-card 
                            :lesson="lesson" 
                            @add-to-cart="addToCart"
                        ></lesson-card>
                    </div>
                </div>
            </div>

            <!-- Shopping Cart View -->
            <div v-if="showCart">
                <div class="cart-header mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h2 class="mb-0">
                                <i class="fas fa-shopping-cart me-2"></i>
                                Shopping Cart
                            </h2>
                            <p class="text-muted mb-0">{{ cart.length }} item(s) in cart</p>
                        </div>
                        <div class="col-md-6 text-end">
                            <button class="btn btn-outline-secondary" @click="showCart = false">
                                <i class="fas fa-arrow-left me-2"></i>
                                Back to Lessons
                            </button>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <!-- Cart Items -->
                    <div class="col-lg-8">
                        <div v-if="cart.length === 0" class="empty-cart">
                            <div class="card text-center py-5">
                                <div class="card-body">
                                    <i class="fas fa-shopping-cart fa-3x text-muted mb-3"></i>
                                    <h4 class="text-muted">Your cart is empty</h4>
                                    <p class="text-muted">Add some lessons to get started!</p>
                                    <button class="btn btn-primary" @click="showCart = false">
                                        Browse Lessons
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div v-else>
                            <div class="cart-items">
                                <div class="card mb-3" v-for="item in cart" :key="item.id">
                                    <div class="card-body">
                                        <div class="row align-items-center">
                                            <div class="col-md-8">
                                                <div class="cart-item-info">
                                                    <h5 class="cart-item-subject mb-2">{{ item.subject }}</h5>
                                                    <div class="cart-item-details">
                                                        <p class="mb-1">
                                                            <i class="fas fa-map-marker-alt me-2 text-primary"></i>
                                                            <strong>Location:</strong> {{ item.location }}
                                                        </p>
                                                        <p class="mb-0">
                                                            <i class="fas fa-pound-sign me-2 text-primary"></i>
                                                            <strong>Price:</strong> Â£{{ item.price }}
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 text-end">
                                                <div class="cart-item-actions">
                                                    <button class="btn btn-danger btn-sm" @click="removeFromCart(item)">
                                                        <i class="fas fa-trash me-1"></i>
                                                        Remove
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Checkout Section -->
                    <div class="col-lg-4">
                        <div v-if="cart.length > 0">
                            <checkout-form 
                                :cart="cart"
                                @checkout="processCheckout"
                            ></checkout-form>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Vue.js 2.7.16 -->
    <script src="https://unpkg.com/vue@2.7.16/dist/vue.js"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="js/app.js"></script>
</body>
</html>
